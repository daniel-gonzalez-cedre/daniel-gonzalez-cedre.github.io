\newlist{detail}{itemize}{2}
\setlist[detail]{label={\boldmath$\cdot$},topsep=0pt,leftmargin=*,noitemsep}

\ifalgorithms
    \newcounter{nalg}[chapter]
    \renewcommand{\thenalg}{\thechapter.\arabic{nalg}}
    \DeclareCaptionLabelFormat{algocaption}{\it Algorithm \thenalg}

    \lstnewenvironment{algorithm}[1][]
    {
        \refstepcounter{nalg}
        \captionsetup{labelformat=algocaption,labelsep=colon}
        \lstset{
            mathescape=true,
            frame=tB,
            numbers=left,
            numberstyle=\tiny,
            basicstyle=\scriptsize,
            keywordstyle=\color{black}\bfseries\em,
            keywords={,input, output, return, datatype, function, in, if, else, elif, for, foreach, while, not, begin, end, true, false, null, break, continue, let, and, or, }
            numbers=left,
            xleftmargin=.04\textwidth,
            #1
        }
    }
    {}
\else
\fi

% new proof environment
\expandafter\let\expandafter\oldproof\csname\string\proof\endcsname
\let\oldendproof\endproof
\renewenvironment{proof}[1][\proofname]{%
    \vspace{-0.5\parskip}%
    \oldproof[#1]
}{%
    ~\\\qed
}

\newtheoremstyle{cedretheorem} % name
    {1ex}  % space above
    {-1ex}  % space below
    {\itshape} % body font
    {}  % indent amount
    {\bfseries}  % theorem head font
    {.\\}  % punctuation after theorem head
    {.5em}  % space after theorem head
    {}  % theorem head spec (can be left empty, meaning ‘normal’)

\newtheoremstyle{cedredefinition} % name
    {1ex}  % space above
    {-1ex}  % space below
    {} % body font
    {}  % indent amount
    {\bfseries}  % theorem head font
    {.\\}  % punctuation after theorem head
    {.5em}  % space after theorem head
    {}  % theorem head spec (can be left empty, meaning ‘normal’)

\newtheoremstyle{cedrenote} % name
    {}  % space above
    {}  % space below
    {} % body font
    {}  % indent amount
    {\bfseries}  % theorem head font
    {.}  % punctuation after theorem head
    {.5em}  % space after theorem head
    {}  % theorem head spec (can be left empty, meaning ‘normal’)

% style for theorems
\theoremstyle{cedretheorem}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}[theorem]
\newtheorem{proposition}{Proposition}[theorem]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{conjecture}{Conjecture}[theorem]
\newtheorem*{claim}{Claim}
\newtheorem*{justification}{Justification}

% style for definitions
\theoremstyle{cedredefinition}
\newtheorem{axiom}{Axiom}
\newtheorem{definition}{Definition}
\newtheorem{notation}{Notation}[definition]
\newtheorem{exercise}{Exercise}[definition]
\newtheorem{example}{Example}[definition]
\newtheorem*{counterexample}{Counterexample}

% style for notes
\theoremstyle{cedrenote}
\newtheorem{idea}{Idea}[definition]
\newtheorem*{remark}{Remark}
\newtheorem*{note}{Note}

\newenvironment{case}[1][Case]
    {\quote\textbf{#1:}~\\}
    {\endquote}

\def\lstlistingautorefname{Algorithm}
\def\itemautorefname{Section}
\renewcommand{\chapterautorefname}{Chapter}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\theoremautorefname}{Theorem}
\newcommand{\axiomautorefname}{Axiom}
\newcommand{\lemmaautorefname}{Lemma}
\newcommand{\propositionautorefname}{Proposition}
\newcommand{\corollaryautorefname}{Corollary}
\newcommand{\claimautorefname}{Claim}
\newcommand{\conjectureautorefname}{Conjecture}
\newcommand{\justificationautorefname}{Justification}
\newcommand{\definitionautorefname}{Definition}
\newcommand{\notationautorefname}{Notation}
\newcommand{\exampleautorefname}{Example}
\newcommand{\counterexampleautorefname}{Counterexample}
\newcommand{\ideaautorefname}{Idea}

\ifbook
    \renewcommand{\theequation}{\thechapter.\arabic{equation}}
    \renewcommand{\thetheorem}{\thechapter.\arabic{theorem}}
    \renewcommand{\thelemma}{\thechapter.\arabic{lemma}}
    \renewcommand{\theproposition}{\thechapter.\arabic{proposition}}
    \renewcommand{\thecorollary}{\thechapter.\arabic{corollary}}
    \renewcommand{\theconjecture}{\thechapter.\arabic{conjecture}}
    % \renewcommand{\theclaim}{\thechapter.\arabic{claim}}
    % \renewcommand{\thejustification}{\thechapter.\arabic{justification}}
    \renewcommand{\thedefinition}{\thechapter.\arabic{definition}}
    \renewcommand{\thenotation}{\thechapter.\arabic{notation}}
    \renewcommand{\theexample}{\thechapter.\arabic{example}}
    % \renewcommand{\thecounterexample}{\thechapter.\arabic{counterexample}}
    \counterwithin*{equation}{chapter}
    \counterwithin*{theorem}{chapter}
    \counterwithin*{lemma}{chapter}
    \counterwithin*{proposition}{chapter}
    \counterwithin*{corollary}{chapter}
    \counterwithin*{conjecture}{chapter}
    % \counterwithin*{claim}{chapter}
    % \counterwithin*{justification}{chapter}
    \counterwithin*{definition}{chapter}
    \counterwithin*{notation}{chapter}
    \counterwithin*{exercise}{chapter}
    \counterwithin*{example}{chapter}
    % \counterwithin*{counterexample}{chapter}
\else
\fi
